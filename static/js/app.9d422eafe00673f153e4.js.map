{"version":3,"sources":["webpack:///./src/assets/img/default_hd.jpg","webpack:///src/components/ChatItem.vue","webpack:///./src/components/ChatItem.vue?8dd7","webpack:///./src/components/ChatItem.vue","webpack:///src/App.vue","webpack:///./src/App.vue?9f74","webpack:///./src/App.vue","webpack:///./src/net/socket.js","webpack:///src/components/ChatArea.vue","webpack:///./src/components/ChatArea.vue?21ee","webpack:///./src/components/ChatArea.vue","webpack:///./src/router/index.js","webpack:///./src/store/index.js","webpack:///./src/main.js"],"names":["module","exports","__webpack_require__","p","ChatItem","name","props","id","String","data","computed","isCurrent","this","$store","state","currentChat","who","isHasNewMsg","noRead","includes","components_ChatItem","render","_h","$createElement","_c","_self","staticClass","class","current","new-msg","attrs","src","_t","staticRenderFns","App","components","normalizeComponent","ssrContext","mounted","user","localStorage","JSON","parse","commit","msgCallback","mask","uid","Number","Date","activeUsers","_this","userList","filter","methods","msg","ct","sendobj","from","content","username","window","to","ok","replace","substr","u","stringify_default","tapChat","selectortype_template_index_0_src_App","_vm","_v","directives","rawName","value","expression","type","maxlength","domProps","on","input","$event","target","composing","$set","click","_e","_m","_s","nativeOn","_l","x","placeholder","src_App","App_normalizeComponent","defaultData","event","socket","WSocket","classCallCheck_default","alert","c","wss","WebSocket","err","assign_default","onopen","send","f","onmessage","evt","ChatArea","currentChatList","watch","$store.state.currentChat.who","handler","curVal","oldVal","_resetCurrentChatStorage","$store.state.isNeedPush","whoName","$refs","innerHTML","conf","hc","sessionStorage","historyChat","setTimeout","chatbox","scrollTop","scrollHeight","components_ChatArea","ref","length","contenteditable","keyup","_k","keyCode","key","ctrlKey","href","src_components_ChatArea","ChatArea_normalizeComponent","vue_esm","use","vue_router_esm","router","routes","path","component","vuex_esm","src_store","Store","isNeedPush","getters","mutations","initConn","callback","open","message","_conf","addChatStorage","info","_ct","date","push","newMsg","cwindow","deleteNewMsg","index","indexOf","splice","actions","config","productionTip","el","store","template"],"mappings":"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","file":"static/js/app.9d422eafe00673f153e4.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/img/default_hd.df7d40a.jpg\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/assets/img/default_hd.jpg\n// module id = FAw5\n// module chunks = 1","<!-- Add \"scoped\" attribute to limit CSS to this component only -->\r\n<style scoped lang=\"less\">\r\n.text {\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n  white-space: nowrap;\r\n  word-wrap: normal;\r\n  font-weight: 400;\r\n  font-size: 13px;\r\n  color: #fff;\r\n  line-height: 20px;\r\n}\r\n.current {\r\n  background-color: #3a3f45;\r\n}\r\n.chat-item {\r\n  display: flex;\r\n  height: 40px;\r\n  padding: 12px 18px; \r\n  cursor: pointer;\r\n  .avatar {\r\n    width: 50px;\r\n    img {\r\n      width: 40px;\r\n      height: 40px;\r\n      border-radius: 3px;\r\n    }\r\n  }\r\n  .new-msg {\r\n    position: relative;\r\n    &:after {\r\n      content: '';\r\n      border: 5px solid red;\r\n      position: absolute;\r\n      top: -5px;\r\n      right: 5px;\r\n      border-radius: 50%;\r\n    }\r\n  }\r\n  .name {\r\n    &:extend(.text);\r\n  }\r\n}\r\n</style>\r\n\r\n<template lang=\"pug\">\r\ndiv.chat-item(:class=\"{'current': isCurrent}\")\r\n  div.avatar(:class=\"{'new-msg': isHasNewMsg}\")\r\n    img(src=\"@/assets/img/default_hd.jpg\")\r\n  div.name\r\n    slot\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: 'ChatItem',\r\n  props: {\r\n    id: String\r\n  },\r\n  data () {\r\n    return {\r\n    }\r\n  },\r\n  computed: {\r\n    // 是否当前\r\n    isCurrent() {\r\n      return this.$store.state.currentChat.who == this.id;\r\n    },\r\n    // 是否显示消息小红点\r\n    isHasNewMsg () {\r\n      return this.$store.state.noRead.includes(String(this.id));\r\n    }\r\n  }\r\n}\r\n</script>\r\n\n\n\n// WEBPACK FOOTER //\n// src/components/ChatItem.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"chat-item\",class:{'current': _vm.isCurrent}},[_c('div',{staticClass:\"avatar\",class:{'new-msg': _vm.isHasNewMsg}},[_c('img',{attrs:{\"src\":require(\"@/assets/img/default_hd.jpg\")}})]),_c('div',{staticClass:\"name\"},[_vm._t(\"default\")],2)])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-3aa62be8\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/template-compiler/preprocessor.js?engine=pug!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/ChatItem.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-3aa62be8\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!less-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./ChatItem.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./ChatItem.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./ChatItem.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-3aa62be8\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/template-compiler/preprocessor?engine=pug!../../node_modules/vue-loader/lib/selector?type=template&index=0!./ChatItem.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-3aa62be8\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/ChatItem.vue\n// module id = null\n// module chunks = ","<style>\r\n  @import \"./assets/font/iconfont.css\";\r\n.topnav_box::-webkit-scrollbar\r\n{  \r\n  width: 5px; \r\n  height:10px;\r\n  background-color:#aaa;\r\n}\r\n.topnav_box::-webkit-scrollbar-track\r\n{  \r\n  -webkit-box-shadow: inset 0 0 6px rgba(0,0,0,0.3);\r\n  border-radius: 10px; \r\n  background-color:#eee;\r\n}\r\n.topnav_box::-webkit-scrollbar-thumb\r\n{  \r\n  border-radius: 10px;  \r\n  -webkit-box-shadow: inset 0 0 6px rgba(0,0,0,.3);\r\n  background-color:#aaa;\r\n}\r\n</style>\r\n<style lang=\"less\" scoped>\r\n  @import \"./assets/css/app\";\r\n</style>\r\n\r\n<template lang=\"pug\">\r\ndiv(id=\"app\")\r\n  div(id=\"mask\" v-if=\"$store.state.mask\")\r\n    div(class=\"panel\")\r\n      div 快帮自己取个名字吧。\r\n      div\r\n        input(type=\"text\" v-model=\"$store.state.user.username\" maxlength=\"6\")\r\n      div(class=\"ok\")\r\n        span(@click=\"ok\") 确定\r\n  div(class=\"main\")\r\n    div(class=\"main-inner\")\r\n      // 左边栏\r\n      div(class=\"sd\")\r\n        // 头部\r\n        div(class=\"m-hd\")\r\n          div(class=\"header\")\r\n            div(class=\"avatar\")\r\n              img(src=\"@/assets/img/default_hd.jpg\")\r\n            div(class=\"info\")\r\n              div(class=\"name\") {{ $store.state.user.username }}\r\n              div(class=\"menu\")\r\n                i(class=\"iconfont icon-menu\")\r\n          div(class=\"search\")\r\n            i(class=\"iconfont icon-sousuo u-search\")\r\n            input(type=\"text\" placeholder=\"搜索\")\r\n          ul(class=\"m-tab\")\r\n            li(class=\"current\")\r\n              i(class=\"iconfont icon-liaotian\")\r\n            li\r\n              i(class=\"iconfont icon-yuedu\")\r\n            li\r\n              i(class=\"iconfont icon-tongxunlu\")\r\n        // 列表\r\n        div(class=\"m-lst-box topnav_box\")\r\n          div(class=\"m-lst\")\r\n            template\r\n              ChatItem(:id=\"'all'\" @click.native=\"tapChat('all', '群聊')\") 群聊\r\n            template(v-for=\"x in activeUsers\")\r\n              chat-item(:id=\"x.uid\" @click.native=\"tapChat(x.uid, x.username)\") {{ x.username }}\r\n      div(class=\"chat-box\")\r\n        router-view\r\n</template>\r\n\r\n<script>\r\nimport ChatItem from '@/components/ChatItem'\r\n\r\nexport default {\r\n  name: 'App',\r\n  components: {\r\n    ChatItem\r\n  },\r\n\r\n  mounted () {\r\n    //初始化用户信息\r\n    let user = localStorage.user;\r\n    if (user) {\r\n      this.$store.state.user = JSON.parse(user);\r\n      // 有历史直接初始化\r\n      this.$store.commit('initConn', this.msgCallback)\r\n      this.$store.state.mask = false;\r\n    } else {\r\n      this.$store.state.user.uid = Number(new Date());\r\n    }\r\n  },\r\n\r\n  computed: {\r\n    // 写成计算属性 排除本身 效率更高\r\n    activeUsers () {\r\n      return this.$store.state.userList.filter( user=> {\r\n        return user.uid != this.$store.state.user.uid;\r\n      })\r\n    }\r\n  },\r\n\r\n  methods : {\r\n    /**\r\n     * 服务器msg消息返回处理回调函数\r\n     */\r\n    msgCallback(msg) {\r\n      // console.log(msg)\r\n      // 直接将聊天记录存储\r\n      const ct = {\r\n        sendobj: msg.from,\r\n        content: msg.data,\r\n        username: msg.username,\r\n        window: msg.to == 'all' ? 'all' : msg.from,\r\n      };\r\n      this.$store.commit('addChatStorage', ct);\r\n      // 之后更新新消息提示\r\n      this.$store.commit('newMsg', ct.window);\r\n    },\r\n\r\n    /**\r\n     * 未有在服务器注册过的输入名称注册\r\n     */\r\n    ok () {\r\n      this.$store.state.user.username = this.$store.state.user.username.replace(/^\\s*/g,'').replace(/\\s*$/g, '').substr(0, 8);\r\n      if (this.$store.state.user.username == '') {\r\n        return;\r\n      }\r\n      const u = {\r\n        'uid': this.$store.state.user.uid,\r\n        'username': this.$store.state.user.username\r\n      }\r\n      localStorage.user = JSON.stringify(u);\r\n      // 初始化连接信息 msg类型信息接收函数注册\r\n      this.$store.commit('initConn', this.msgCallback)\r\n      this.$store.state.mask = false;\r\n    },\r\n\r\n    /**\r\n     * 选择聊天对象\r\n     */\r\n    tapChat (who, name) {\r\n      this.$store.state.currentChat = {\r\n        who: who,\r\n        name: name\r\n      };\r\n      // 如果有新消息红点 则取消\r\n      this.$store.commit('deleteNewMsg', who);\r\n    }\r\n  }\r\n}\r\n</script>\r\n\n\n\n// WEBPACK FOOTER //\n// src/App.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[(_vm.$store.state.mask)?_c('div',{attrs:{\"id\":\"mask\"}},[_c('div',{staticClass:\"panel\"},[_c('div',[_vm._v(\"快帮自己取个名字吧。\")]),_c('div',[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.$store.state.user.username),expression:\"$store.state.user.username\"}],attrs:{\"type\":\"text\",\"maxlength\":\"6\"},domProps:{\"value\":(_vm.$store.state.user.username)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.$set(_vm.$store.state.user, \"username\", $event.target.value)}}})]),_c('div',{staticClass:\"ok\"},[_c('span',{on:{\"click\":_vm.ok}},[_vm._v(\"确定\")])])])]):_vm._e(),_c('div',{staticClass:\"main\"},[_c('div',{staticClass:\"main-inner\"},[_c('div',{staticClass:\"sd\"},[_c('div',{staticClass:\"m-hd\"},[_c('div',{staticClass:\"header\"},[_vm._m(0),_c('div',{staticClass:\"info\"},[_c('div',{staticClass:\"name\"},[_vm._v(_vm._s(_vm.$store.state.user.username))]),_vm._m(1)])]),_vm._m(2),_vm._m(3)]),_c('div',{staticClass:\"m-lst-box topnav_box\"},[_c('div',{staticClass:\"m-lst\"},[[_c('ChatItem',{attrs:{\"id\":'all'},nativeOn:{\"click\":function($event){_vm.tapChat('all', '群聊')}}},[_vm._v(\"群聊\")])],_vm._l((_vm.activeUsers),function(x){return [_c('chat-item',{attrs:{\"id\":x.uid},nativeOn:{\"click\":function($event){_vm.tapChat(x.uid, x.username)}}},[_vm._v(_vm._s(x.username))])]})],2)])]),_c('div',{staticClass:\"chat-box\"},[_c('router-view')],1)])])])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"avatar\"},[_c('img',{attrs:{\"src\":require(\"@/assets/img/default_hd.jpg\")}})])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"menu\"},[_c('i',{staticClass:\"iconfont icon-menu\"})])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"search\"},[_c('i',{staticClass:\"iconfont icon-sousuo u-search\"}),_c('input',{attrs:{\"type\":\"text\",\"placeholder\":\"搜索\"}})])},function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('ul',{staticClass:\"m-tab\"},[_c('li',{staticClass:\"current\"},[_c('i',{staticClass:\"iconfont icon-liaotian\"})]),_c('li',[_c('i',{staticClass:\"iconfont icon-yuedu\"})]),_c('li',[_c('i',{staticClass:\"iconfont icon-tongxunlu\"})])])}]\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-4bc5d492\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/template-compiler/preprocessor.js?engine=pug!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/App.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-4bc5d492\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../node_modules/vue-loader/lib/selector?type=styles&index=0!./App.vue\")\n  require(\"!!../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-4bc5d492\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!less-loader?{\\\"sourceMap\\\":true}!../node_modules/vue-loader/lib/selector?type=styles&index=1!./App.vue\")\n}\nvar normalizeComponent = require(\"!../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../node_modules/vue-loader/lib/selector?type=script&index=0!./App.vue\"\nimport __vue_script__ from \"!!babel-loader!../node_modules/vue-loader/lib/selector?type=script&index=0!./App.vue\"\n/* template */\nimport __vue_template__ from \"!!../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-4bc5d492\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../node_modules/vue-loader/lib/template-compiler/preprocessor?engine=pug!../node_modules/vue-loader/lib/selector?type=template&index=0!./App.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-4bc5d492\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/App.vue\n// module id = null\n// module chunks = ","const defaultData = {\r\n  event: 'msg',\r\n  from: '',\r\n  username: '',\r\n  to: \"all\",\r\n  type: 'text',\r\n  data: ''\r\n}\r\n\r\nclass WSocket {\r\n  wss;\r\n\r\n  constructor() {\r\n    if (!\"WebSocket\" in window) {\r\n      alert(\"您的浏览器不支持 WebSocket!\");\r\n    }\r\n  }\r\n\r\n  open (c) {\r\n    // 貌似不在短时间内调用onopen 会自动调用，所以在此处new\r\n    try {\r\n      this.wss = new WebSocket(\"ws://120.78.206.114:18081\");\r\n    } catch( err ) {\r\n      alert('连接服务器失败');\r\n    }\r\n    c = Object.assign(defaultData, c);\r\n    this.wss.onopen = function() {\r\n      this.send(JSON.stringify(c));\r\n    };\r\n  }\r\n\r\n  message (f) {\r\n    this.wss.onmessage = function(evt) {\r\n      f(evt.data);\r\n    };\r\n  }\r\n  \r\n  send (c) {\r\n    c = Object.assign(defaultData, c);\r\n    this.wss.send(JSON.stringify(c));\r\n  }\r\n\r\n}\r\n\r\nexport default new WSocket();\n\n\n// WEBPACK FOOTER //\n// ./src/net/socket.js","<!-- Add \"scoped\" attribute to limit CSS to this component only -->\r\n<style scoped lang=\"less\">\r\n@import \"../assets/css/chat_area\";\r\n</style>\r\n\r\n<template lang=\"pug\">\r\ndiv.chat-area\r\n  div.box-hd\r\n    div.title {{ whoName }}\r\n\r\n  div.chat-bd.topnav_box(ref=\"chatbox\")\r\n    div.empty(v-if=\"currentChatList.length == 0\") 暂时没有新消息\r\n    //- div.msg-item.msg-item-left.clearfix(v-for=\"x in '123'\")\r\n    //-   div.nt-item\r\n    //-     img.image(src=\"@/assets/img/default_hd.jpg\")\r\n    //-     div.content 可垃圾咯啦咯啦咯啦咯啦咯啦咯啦咯火辣辣啦啦啦啦啦啦啦啦芭芭拉巴巴爸爸火辣辣啦啦啦啦啦啦啦啦芭芭拉巴巴爸爸\r\n    //- div.msg-item.msg-item-right.clearfix(v-for=\"x in '123'\")\r\n    //-   div.nt-item\r\n    //-     div.content 可垃圾咯啦可垃圾咯啦咯啦咯啦咯啦咯啦咯啦咯火辣辣啦啦啦啦啦啦啦啦芭芭拉巴巴爸爸火辣辣啦啦啦啦啦啦啦啦芭芭拉巴巴爸爸\r\n    //-     img.image(src=\"@/assets/img/default_hd.jpg\")\r\n    template(v-for=\"x in currentChatList\")\r\n      div.msg-item.clearfix.msg-item-left(v-if= \"x.sendobj != 'me'\")\r\n        div.nt-item\r\n          img.image(src=\"@/assets/img/default_hd.jpg\")\r\n          div \r\n            div.show-name(v-if=\"who=='all'\") {{ x.username }}\r\n            div.content(v-html=\"x.content\")\r\n      div.msg-item.msg-item-right.clearfix(v-else=\"\")\r\n        div.nt-item\r\n          div.content(v-html=\"x.content\")\r\n          img.image(src=\"@/assets/img/default_hd.jpg\")\r\n  div.m-ft\r\n    ul.tool-tab\r\n      li\r\n        i.iconfont.icon-face\r\n      li\r\n        i.iconfont.icon-cut\r\n      li\r\n        i.iconfont.icon-file\r\n    div.content\r\n      div.input(contenteditable=\"true\" ref=\"input\" @keyup.ctrl.enter=\"send\")\r\n\r\n    div.action\r\n      span.notice 按ctrl+enter发送\r\n      a.u-send(href=\"javascript:void(0)\" @click=\"send\") 发送\r\n</template>\r\n\r\n<script>\r\nimport ws from '@/net/socket'\r\nexport default {\r\n  name: 'ChatArea',\r\n  data () {\r\n    return {\r\n      currentChatList: [], // 聊天记录\r\n    }\r\n  },\r\n  // 监听器 用于监听何时该刷新数据\r\n  watch: {\r\n    // 输入名称后刷新 貌似不需要 此时并没有聊天数据\r\n    // '$store.state.mask':{\r\n    //   handler(curVal,oldVal){\r\n    //     //监听变量变化，发送请求\r\n    //     this._resetCurrentChatStorage();\r\n    //   },\r\n    //   // deep:true\r\n    // },\r\n    // 改变聊天对象\r\n    '$store.state.currentChat.who': {\r\n      handler(curVal, oldVal) {\r\n        this._resetCurrentChatStorage();\r\n      }\r\n    },\r\n    // 控制刷新 新消息时\r\n    '$store.state.isNeedPush': {\r\n      handler(curVal, oldVal) {\r\n        this._resetCurrentChatStorage();\r\n      }\r\n    }\r\n  },\r\n  // 增加两个计算属性 方便处理\r\n  computed: {\r\n    who () {\r\n      return this.$store.state.currentChat.who;\r\n    },\r\n    whoName() {\r\n      return this.$store.state.currentChat.name;\r\n    }\r\n  },\r\n  methods: {\r\n    /**\r\n     * 发送消息\r\n     */\r\n    send () {\r\n      let content = this.$refs.input.innerHTML;\r\n      content = content.replace(/^\\s*/g,'').replace(/\\s*$/g, '').substr(0, 200); // max 最大发送200\r\n      if (!content) {\r\n        return;\r\n      }\r\n      const conf = {\r\n        to: this.who, //发送给当前窗口聊天对象\r\n        data: content,\r\n      };\r\n      this.$store.commit('send', conf)\r\n      // 保存聊天记录 sessionStorage.historyChat\r\n      this.$store.commit('addChatStorage', {\r\n        content,\r\n        sendobj: 'me', //代表自己发的\r\n        username: this.$store.state.user.username, //发送人名称\r\n        // 聊天窗口对象\r\n        window: this.who\r\n      });\r\n      // 重新初始化 再清空输入框\r\n      this._resetCurrentChatStorage();\r\n      this.$refs.input.innerHTML = '';\r\n    },\r\n\r\n    /**\r\n     * 重新初始化聊天界面 获取聊天记录\r\n     */\r\n    _resetCurrentChatStorage () {\r\n      const hc = (sessionStorage.historyChat && JSON.parse(sessionStorage.historyChat)) || {};\r\n      this.currentChatList = hc[this.who] ? hc[this.who] : [];\r\n      // 同时将滚动条放置聊天底部 这里要延时才行，原因不明\r\n      setTimeout(()=> {\r\n        this.$refs.chatbox.scrollTop = this.$refs.chatbox.scrollHeight;\r\n      }, 10);\r\n    }\r\n  },\r\n  // 页面初始化\r\n  mounted () {\r\n    this._resetCurrentChatStorage();\r\n  }\r\n}\r\n</script>\r\n\n\n\n// WEBPACK FOOTER //\n// src/components/ChatArea.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"chat-area\"},[_c('div',{staticClass:\"box-hd\"},[_c('div',{staticClass:\"title\"},[_vm._v(_vm._s(_vm.whoName))])]),_c('div',{ref:\"chatbox\",staticClass:\"chat-bd topnav_box\"},[(_vm.currentChatList.length == 0)?_c('div',{staticClass:\"empty\"},[_vm._v(\"暂时没有新消息\")]):_vm._e(),_vm._l((_vm.currentChatList),function(x){return [(x.sendobj != 'me')?_c('div',{staticClass:\"msg-item clearfix msg-item-left\"},[_c('div',{staticClass:\"nt-item\"},[_c('img',{staticClass:\"image\",attrs:{\"src\":require(\"@/assets/img/default_hd.jpg\")}}),_c('div',[(_vm.who=='all')?_c('div',{staticClass:\"show-name\"},[_vm._v(_vm._s(x.username))]):_vm._e(),_c('div',{staticClass:\"content\",domProps:{\"innerHTML\":_vm._s(x.content)}})])])]):_c('div',{staticClass:\"msg-item msg-item-right clearfix\"},[_c('div',{staticClass:\"nt-item\"},[_c('div',{staticClass:\"content\",domProps:{\"innerHTML\":_vm._s(x.content)}}),_c('img',{staticClass:\"image\",attrs:{\"src\":require(\"@/assets/img/default_hd.jpg\")}})])])]})],2),_c('div',{staticClass:\"m-ft\"},[_vm._m(0),_c('div',{staticClass:\"content\"},[_c('div',{ref:\"input\",staticClass:\"input\",attrs:{\"contenteditable\":\"true\"},on:{\"keyup\":function($event){if(!('button' in $event)&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }if(!$event.ctrlKey){ return null; }return _vm.send($event)}}})]),_c('div',{staticClass:\"action\"},[_c('span',{staticClass:\"notice\"},[_vm._v(\"按ctrl+enter发送\")]),_c('a',{staticClass:\"u-send\",attrs:{\"href\":\"javascript:void(0)\"},on:{\"click\":_vm.send}},[_vm._v(\"发送\")])])])])}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('ul',{staticClass:\"tool-tab\"},[_c('li',[_c('i',{staticClass:\"iconfont icon-face\"})]),_c('li',[_c('i',{staticClass:\"iconfont icon-cut\"})]),_c('li',[_c('i',{staticClass:\"iconfont icon-file\"})])])}]\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-00e956d5\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/template-compiler/preprocessor.js?engine=pug!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/ChatArea.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-00e956d5\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!less-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./ChatArea.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./ChatArea.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./ChatArea.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-00e956d5\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/template-compiler/preprocessor?engine=pug!../../node_modules/vue-loader/lib/selector?type=template&index=0!./ChatArea.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-00e956d5\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/ChatArea.vue\n// module id = null\n// module chunks = ","import Vue from 'vue'\nimport Router from 'vue-router'\nimport ChatArea from '@/components/ChatArea'\n\nVue.use(Router)\n\nexport default new Router({\n  routes: [\n    {\n      path: '/',\n      name: 'ChatArea',\n      component: ChatArea\n    }\n  ]\n})\n\n\n\n// WEBPACK FOOTER //\n// ./src/router/index.js","import Vue from 'vue'\r\nimport Vuex from 'vuex'\r\nimport ws from '@/net/socket'\r\n\r\nVue.use(Vuex)\r\n\r\nconst store = new Vuex.Store({\r\n  state: {\r\n    // 用户信息\r\n    user: {\r\n      username: '',\r\n      uid: ''\r\n    },\r\n    // 在线用户\r\n    userList: [],\r\n    // 当前窗口信息\r\n    currentChat: {\r\n      who: 'all',\r\n      name: '群聊'\r\n    },\r\n    // 输入名称控制\r\n    mask: true,\r\n    isNeedPush: 0, // 控制了解界面刷新显示消息\r\n    // 未读信息记录, 数组简单处理 \r\n    noRead: []\r\n  },\r\n  getters: {\r\n  },\r\n  mutations: {\r\n    // 初始化连接 注册\r\n    initConn (state, callback) {\r\n      const u = {\r\n        event: 'reg',\r\n        from: state.user.uid,\r\n        username: state.user.username,\r\n        to: 'all',\r\n        data: state.user.username + '上线啦'\r\n      }\r\n      ws.open(u);\r\n      ws.message((msg)=>{\r\n        msg = JSON.parse(msg);\r\n        if (msg.event == 'msg') {\r\n          // 消息\r\n          callback(msg);\r\n        }\r\n        else if (msg.event == 'user') {\r\n          //用户列表信息\r\n          if (state.userList != msg.data) {\r\n            state.userList = msg.data;\r\n          }\r\n          \r\n        }\r\n      }); \r\n    },\r\n\r\n    // 消息推送\r\n    send (state, conf) {\r\n      let _conf = {\r\n        event: 'msg',\r\n        from: state.user.uid,\r\n        username: state.user.username,\r\n        to: 'all',\r\n        data: ''\r\n      };\r\n      _conf = Object.assign(_conf, conf);\r\n      ws.send(_conf);\r\n    },\r\n\r\n    // 保存聊天记录 sessionStorage.historyChat\r\n    addChatStorage(state, info) {\r\n      let hc = (sessionStorage.historyChat && JSON.parse(sessionStorage.historyChat)) || {};\r\n      const _ct = {\r\n        sendobj: info.sendobj,   // 谁发的\r\n        content: info.content,  // 发送内容\r\n        username: info.username, //发送人名称\r\n        // 聊天窗口对象\r\n        window: info.window,\r\n        date: Number(new Date())\r\n      }\r\n      // 聊天记录对应某个聊天窗口对象\r\n      if (!hc[_ct.window]) {\r\n        hc[_ct.window] = [];\r\n      }\r\n      hc[_ct.window].push(_ct);\r\n      sessionStorage.historyChat = JSON.stringify(hc);\r\n    },\r\n\r\n    /**\r\n     * 新消息提示\r\n     */\r\n    newMsg (state, cwindow) {\r\n       // 先判断 如果是当前窗口，直接更新 无需加入新消息提示数组\r\n       if (cwindow == state.currentChat.who) {\r\n        state.isNeedPush++; //改变即可\r\n       } else {\r\n        // 没有则加入提示数组\r\n        if (!state.noRead.includes(String(cwindow))) {\r\n          state.noRead.push(String(cwindow));\r\n        }\r\n       }\r\n    },\r\n\r\n    /**\r\n     * 取消某个消息提示红点\r\n     */\r\n    deleteNewMsg (state, cwindow) {\r\n      cwindow = String(cwindow);\r\n      const index = state.noRead.indexOf(cwindow);\r\n      if (index > -1) {\r\n          state.noRead.splice(index, 1);\r\n      }\r\n    }\r\n  },\r\n  actions: {\r\n  }\r\n});\r\n\r\nexport default store;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/store/index.js","// The Vue build version to load with the `import` command\n// (runtime-only or standalone) has been set in webpack.base.conf with an alias.\nimport Vue from 'vue'\nimport App from './App'\nimport router from './router'\nimport store from './store'\n\nVue.config.productionTip = false\n\n/* eslint-disable no-new */\nnew Vue({\n  el: '#app',\n  store,\n  router,\n  components: { App },\n  template: '<App/>'\n})\n\n\n\n// WEBPACK FOOTER //\n// ./src/main.js"],"sourceRoot":""}